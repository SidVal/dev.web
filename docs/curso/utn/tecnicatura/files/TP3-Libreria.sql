--LABORATORIO II - GUIA EJERCICIOS 3
--Composiciones Simples


use Libreria

--1) Liste número de factura, fecha de venta y vendedor (apellido y nombre), 
--para los casos en que el código del cliente van del 2 al 6. --Ordene por vendedor y fecha, ambas en forma descendente.SELECT F.nro_factura, F.fecha, V.nom_Vendedor, V.ape_Vendedor, C.cod_ClienteFROM facturas F, vendedores V, clientes CWHERE F.cod_Vendedor = V.cod_VendedorAND F.cod_Cliente = C.cod_ClienteAND C.cod_Cliente BETWEEN 2 AND 6ORDER BY V.ape_Vendedor DESC, F.fecha DESC--2) Emitir un reporte con los datos de la factura del cliente 
--y del vendedor de aquellas facturas confeccionadas entre el 
-- primero de febrero del 2008 y el primero de marzo del 2010 
--y que el apellido del cliente no contenga “C”.SELECT F.nro_Factura, F.fecha,C.Cod_Cliente,C.nom_Cliente,C.ape_Cliente,C.calle,C.altura,C.cod_Barrio,C.nro_Tel,C.[e-mail],V.cod_Vendedor,V.nom_Vendedor,V.ape_Vendedor,V.calle,V.altura,V.cod_Barrio,V.nro_Tel,V.[e-mail],V.fec_NacFROM facturas F, clientes C, vendedores VWHERE F.cod_cliente = C.cod_Cliente AND F.cod_Vendedor = V.cod_VendedorAND F.fecha between '01/02/2008' AND '01/03/2010'AND C.ape_Cliente NOT LIKE '%C%'-- 3) Listar los datos de la factura, los del artículo y 
-- el importe (precio por cantidad); para las facturas emitidas 
-- en el 2009, 2010 y 2012 y la descripción no comience con “R”. 
--Ordene por número de factura e importe, este en forma descendente. --Rotule. SELECT F.nro_factura,F.fecha,F.cod_Cliente, F.cod_Vendedor,A.cod_Articulo,A.descripcion,A.Stock_Minimo,A.pre_Unitario as 'Precio Uni Lista',A.observaciones,D.pre_Unitario as 'Precio Uni Factura',D.cantidad,D.pre_Unitario*D.Cantidad as 'Importe'FROM facturas F,articulos A,detalle_Facturas DWHERE F.nro_Factura = D.nro_FacturaAND D.cod_Articulo = A.cod_ArticuloAND Year(F.fecha) IN (2009,2010,2012)AND A.descripcion NOT LIKE 'R%'ORDER BY F.nro_Factura, 'Importe' desc--4) Se quiere saber qué artículos se vendieron, 
--siempre que el precio al que fue vendido no esté entre $10 y $50. 
--Rotule como: Código de Artículo, Descripción, Cantidad e Importe 
--(El importe es el precio por la cantidad). SELECT A.cod_Articulo as 'Código de Articulo', A.descripcion as 'Descripción',D.cantidad as 'Cantidad',D.pre_Unitario * D.cantidad as 'Importe', D.pre_unitarioFROM detalle_Facturas D, articulos AWHERE D.cod_Articulo = A.cod_Articuloand D.pre_unitario NOT BETWEEN 10 AND 50--5) Liste todos los datos de la factura (vendedor, cliente, artículo, 
--incluidos los datos de la venta); emitidas a clientes con teléfonos 
--o direcciones de e-mail conocidas de aquellas facturas cuyo 
-- importe haya sido superior a $250. 
-- Agregue rótulos presentación y ordene el listado para darle mejor
--presentación.SELECT F.nro_Factura,F.fecha,D.pre_Unitario * D.cantidad as 'Importe',C.nom_Cliente + ' ' + C.ape_Cliente as 'Nombre y Apellido Cliente',V.nom_Vendedor + ' ' + V.ape_Vendedor as 'Nombre y Apellido Vendedor',A.cod_Articulo as 'Codigo de Articulo', A.descripcionFROM facturas F,detalle_Facturas D, articulos A, vendedores V, clientes CWHERE F.nro_Factura = D.nro_FacturaAND F.cod_Cliente = C.cod_ClienteAND F.cod_Vendedor = V.cod_VendedorAND D.cod_Articulo = A.cod_ArticuloAND (C.nro_Tel is not null OR C.[e-mail] is not null)AND (D.pre_Unitario*D.cantidad)>250ORDER BY F.nro_Factura--6) Se quiere saber a qué cliente, de qué barrio, vendedor 
--y en qué fecha se les vendió con los siguientes nros. de factura: 12, 18, 1, 3, 35, 26 y 29.SELECT F.nro_Factura,C.nom_Cliente + ' ' + C.ape_Cliente as 'NOMBRE Y APELLIDO CLIENTE',B.barrio, V.nom_Vendedor + ' ' + V.ape_Vendedor as 'NOMBRE Y APELLIDO VENDEDOR'FROM facturas F, clientes C, barrios B, vendedores VWHERE F.cod_cliente = C.cod_ClienteAND F.cod_Vendedor = V.cod_VendedorAND C.cod_Barrio = B.cod_BarrioAND F.nro_Factura IN (12,18,1,3,35,26,29)--7) Emitir un reporte para informar qué artículos se vendieron, 
--en las facturas cuyos números no esté entre 17 y 136. 
--Liste la descripción, cantidad e importe. Ordene por descripción y cantidad. No
--muestre las filas con valores duplicadosSELECT DISTINCT A.cod_Articulo, A.descripcion,D.Cantidad, D.pre_Unitario * D.Cantidad as 'Importe'FROM facturas F, detalle_Facturas D, articulos AWHERE F.nro_Factura = D.nro_FacturaAND D.cod_Articulo = A.cod_ArticuloAND F.nro_Factura NOT BETWEEN 17 AND 136ORDER BY A.descripcion, D.cantidad--8) Listar los datos de las facturas (cliente, artículo, incluidos los datos de la --venta incluido el importe) emitidas a los clientes cuyos apellidos comiencen con --letras que van de la “l” a “s” o los artículos vendidos que tengan descripciones --que comiencen con las mismas letras. Ordenar el listado.SELECT F.nro_Factura,F.fecha,D.pre_Unitario * D.cantidad as 'Importe',C.nom_Cliente + ' ' + C.ape_Cliente as 'Nombre y Apellido Cliente',A.cod_Articulo as 'Codigo de Articulo', A.descripcionFROM facturas F,detalle_Facturas D, articulos A,clientes CWHERE F.nro_Factura = D.nro_FacturaAND D.cod_Articulo = A.cod_ArticuloAND F.cod_Cliente = C.cod_ClienteAND (C.ape_Cliente LIKE '[L-S]%' OR A.descripcion LIKE '[L-S]%')ORDER BY nro_Factura,'Nombre y Apellido Cliente'--9) Realizar un reporte de los artículos que se vendieron en lo que va del año. --(Muestre los datos que sean significativos para el usuario del sistema --usando rótulos para que sea más legible y que los artículos no se muestren repetidos).SELECT DISTINCT D.nro_Factura as 'Nro. Factura', F.fecha,D.pre_Unitario as 'Precio Unitario Facturado',D.cantidad,A.cod_Articulo,A.descripcionFROM facturas F, detalle_Facturas D, articulos AWHERE D.cod_Articulo = A.cod_ArticuloAND F.nro_Factura = D.nro_FacturaAND year(F.fecha) = year(getdate())ORDER BY F.fecha DESC--10) Se quiere saber a qué clientes se les vendió el año pasado, --qué vendedor le realizó la venta, y qué artículos compró, --siempre que el vendedor que les vendió sea menor de 35 años.SELECT F.nro_Factura,F.fecha, C.nom_Cliente + ' ' + C.ape_Cliente as 'Nombre y Apellido Cliente',V.nom_Vendedor + ' ' + V.ape_Vendedor as 'Nombre y Apellido Vendedor',V.fec_Nac, A.cod_Articulo as 'Codigo de Articulo', A.descripcion, DATEDIFF(year,V.fec_Nac,GETDATE()) AS 'Edad'FROM facturas F,detalle_Facturas D, articulos A, vendedores V, clientes CWHERE F.nro_Factura = D.nro_FacturaAND F.cod_Cliente = C.cod_ClienteAND F.cod_Vendedor = V.cod_VendedorAND D.cod_Articulo = A.cod_ArticuloAND Year(F.fecha) = Year(GetDate())-1AND DATEDIFF(year,V.fec_Nac,GETDATE()) <35-- Calcular Edad--11) El usuario de este sistema necesita ver el listado de facturas, de aquellos artículos --cuyos precios unitarios a los que fueron vendidos estén entre 50 y 100 y de aquellos --vendedores cuyo apellido no comience con letras que van de la “l” a la “m”. --Ordenado por vendedor, fecha e importe.SELECT F.nro_Factura, F.fecha, D.pre_Unitario,D.cantidad, D.pre_Unitario * D.cantidad as 'Importe',A.cod_Articulo, A.descripcion, V.ape_VendedorFROM facturas F, detalle_Facturas D, articulos A,vendedores VWHERE F.nro_Factura = D.nro_FacturaAND D.cod_Articulo = A.cod_ArticuloAND F.cod_Vendedor = V.cod_VendedorAND D.pre_Unitario between 50 and 100AND V.ape_Vendedor not like '[l-m]%'ORDER BY V.ape_Vendedor, F.fecha, D.pre_Unitario * D.cantidad--12) Se desea emitir un listado de clientes que compraron en enero, --además saber qué compraron cuánto gastaron --(mostrar los datos en forma conveniente)SELECT DISTINCT C.nom_Cliente + ' ' + C.ape_Cliente as 'Nombre y Apellido Cliente',D.pre_Unitario * D.cantidad as 'Importe', A.cod_Articulo,A.descripcion,Month(F.fecha) as 'Mes'FROM facturas F, detalle_Facturas D, clientes C, articulos AWHERE F.cod_Cliente = C.cod_ClienteAND D.nro_Factura = F.nro_FacturaAND D.cod_Articulo = A.cod_ArticuloAND Month(F.fecha) = 1--13) Emitir un reporte de artículos vendidos en el 2010 a qué precios se vendieron --y qué precio tienen hoy.SELECT DISTINCT A.cod_Articulo, A.descripcion, D.pre_Unitario as 'Precio en el 2010', A.pre_Unitario as 'Precio Actual'FROM facturas F, detalle_Facturas D, articulos AWHERE D.nro_Factura = F.nro_FacturaAND D.cod_Articulo = A.cod_ArticuloAND YEAR(F.fecha) =2010ORDER BY cod_Articulo--14) Listar los vendedores que hace 10 años le vendieron a clientes 
--cuyos nombres o apellidos comienzan con "C"

SELECT F.fecha, 
V.nom_Vendedor + ' ' +  V.ape_Vendedor as 'Nombre y Apellido Vendedor',
C.nom_Cliente + ' ' + C.ape_Cliente as 'Nombre y Apellido Cliente'
FROM facturas F, clientes C, vendedores V
WHERE F.cod_Cliente = C.cod_Cliente
AND F.cod_Vendedor = V.cod_Vendedor
AND Year(F.fecha) = Year(GetDate())-10
and (C.nom_cliente LIKE 'r%' OR C.ape_cliente LIKE 'C%')


--15) El encargado de la librería necesita tener información sobre los artículos --que se vendían a menos de $ 10 antes del 2005. --Mostrar los datos que se consideren relevantes para el encargado, rotular y ordenar.SELECT DISTINCT A.cod_Articulo, A.descripcion, D.pre_Unitario as 'Precio en el 2005'FROM facturas F, detalle_Facturas D, articulos AWHERE D.nro_Factura = F.nro_FacturaAND D.cod_Articulo = A.cod_ArticuloAND YEAR(F.fecha) <2005AND D.pre_Unitario <10ORDER BY cod_Articulo